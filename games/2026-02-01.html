<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Common Thread â€” Daily Word Game</title>
<style>
  :root{
    --bg: #0f1320;
    --panel: #151a2b;
    --ink: #e9ecf1;
    --muted: #a7afc2;
    --accent: #6dd5fa;
    --accent-2: #00c2ff;
    --good: #36d399;
    --bad: #ff6b6b;
    --warn: #ffd166;
    --tile: #1f2540;
    --thread: #ffd166;
    --shadow: 0 6px 20px rgba(0,0,0,0.25);
    --radius: 12px;
  }
  @media (prefers-color-scheme: light){
    :root{
      --bg: #f6f8fc;
      --panel: #ffffff;
      --ink: #1a2433;
      --muted: #5b6780;
      --accent: #0ea5e9;
      --accent-2: #06b6d4;
      --good: #16a34a;
      --bad: #dc2626;
      --tile: #eef2ff;
      --thread: #f59e0b;
      --shadow: 0 6px 18px rgba(16,24,40,0.08);
    }
  }
  html,body{
    height:100%;
    margin:0;
    background: radial-gradient(1200px 600px at 20% -10%, #1b2140 0%, var(--bg) 60%) no-repeat,
                radial-gradient(1000px 600px at 100% 0%, #0b0f1d 0%, var(--bg) 70%) no-repeat,
                var(--bg);
    color: var(--ink);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
  }
  .wrap{
    max-width: 860px;
    margin: 0 auto;
    padding: 16px clamp(12px, 4vw, 24px) 24px;
    display:flex;
    flex-direction:column;
    gap: 16px;
    min-height:100%;
    box-sizing:border-box;
  }
  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }
  .title{
    display:flex;
    align-items:baseline;
    gap: 12px;
  }
  h1{
    font-size: clamp(20px, 3.2vw, 28px);
    line-height:1.1;
    margin:0;
    letter-spacing:0.3px;
  }
  .date{
    font-size: clamp(12px, 2.2vw, 14px);
    color: var(--muted);
  }
  .help-btn{
    border: none;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color:white;
    padding: 10px 14px;
    border-radius: 999px;
    box-shadow: var(--shadow);
    font-weight:600;
    cursor:pointer;
    min-height:44px;
  }
  .panel{
    background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
  }
  .rules{
    padding: 14px 16px;
    display:none;
  }
  .rules.open{ display:block; }
  .rules p, .rules li{ color: var(--muted); margin: 8px 0; }
  .rules ul{ padding-left: 18px; margin: 8px 0 0; }
  .thread-panel{
    display:flex;
    flex-direction:column;
    gap: 10px;
    padding: 14px;
  }
  .thread-top{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .thread-label{
    font-weight:700;
    letter-spacing:0.5px;
  }
  .thread-boxes{
    display:flex;
    gap:8px;
  }
  .tbox{
    width: 42px; height: 42px;
    display:grid; place-items:center;
    background: var(--tile);
    border-radius:10px;
    font-weight:800;
    font-size: 18px;
    letter-spacing:1px;
    color: var(--ink);
    border:1px solid rgba(255,255,255,0.06);
  }
  .tbox.revealed{
    background: linear-gradient(180deg, var(--thread), #ffca63);
    color: #2b1f00;
  }
  .thread-input-wrap{
    display:flex; align-items:center; gap:10px; flex-wrap:wrap;
  }
  .thread-input{
    width: 120px;
    min-height: 44px;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.12);
    background: var(--panel);
    color: var(--ink);
    font-weight:700;
    text-transform: uppercase;
    letter-spacing: 2px;
    padding: 10px 12px;
    font-size: 16px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
  }
  .btn{
    min-height:44px;
    padding:10px 14px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.12);
    background: var(--panel);
    color: var(--ink);
    font-weight:600;
    cursor:pointer;
  }
  .btn.primary{
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color:white; border:none;
  }
  .btn.good{
    background: linear-gradient(135deg, #40df9f, #2cb17b);
    color: #052d1e; border:none;
  }
  .btn:disabled{ opacity:0.6; cursor:not-allowed; }
  .clues{
    display:grid;
    grid-template-columns: 1fr;
    gap: 12px;
  }
  .clue{
    display:grid;
    grid-template-columns: auto 1fr;
    gap: 10px 12px;
    align-items:center;
    padding: 12px;
    border-radius: var(--radius);
    border:1px solid rgba(255,255,255,0.08);
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
  }
  .num{
    width: 36px; height: 36px;
    min-width:36px;
    display:grid; place-items:center;
    border-radius: 10px;
    font-weight:800;
    color:#0b1224;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
  }
  .clue-text{
    font-weight:600; letter-spacing:0.2px;
  }
  .answer-area{
    grid-column: 1 / -1;
    display:flex; align-items:center; gap:10px; flex-wrap:wrap;
  }
  .answer-input{
    flex:1 1 240px;
    min-width: 160px;
    min-height: 48px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.12);
    background: var(--panel);
    color: var(--ink);
    font-weight:700;
    text-transform: uppercase;
    letter-spacing:1.2px;
    padding: 12px 12px;
    font-size:16px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
  }
  .status{
    font-size: 13px;
    color: var(--muted);
  }
  .status.good{ color: var(--good); font-weight:700; }
  .status.bad{ color: var(--bad); font-weight:700; }
  .tiles{
    display:flex; gap:6px; flex-wrap:wrap;
  }
  .tile{
    width: 36px; height: 44px;
    display:grid; place-items:center;
    background: var(--tile);
    border-radius: 8px;
    font-weight:800;
    color: var(--ink);
    border:1px solid rgba(255,255,255,0.06);
  }
  .tile.thread{
    background: linear-gradient(180deg, var(--thread), #ffca63);
    color: #2b1f00;
  }
  .win{
    display:none;
    padding: 14px;
    border-radius: var(--radius);
    border:1px solid rgba(255,255,255,0.12);
    background: linear-gradient(180deg, rgba(64,223,159,0.12), rgba(64,223,159,0.08));
  }
  .win.show{ display:block; }
  .win h2{
    margin:0 0 4px 0; font-size: clamp(18px, 3vw, 22px);
  }
  .win p{ margin:4px 0; color: var(--muted); }
  footer{
    margin-top:auto;
    display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
    color: var(--muted);
    font-size: 12px;
  }
  .share-wrap{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .pill{
    padding: 6px 10px;
    border-radius: 999px;
    background: rgba(255,255,255,0.06);
    border:1px solid rgba(255,255,255,0.08);
  }
  @media (min-width: 720px){
    .clues{
      grid-template-columns: 1fr 1fr;
    }
  }
  @media (max-height: 720px){
    .rules{ font-size: 14px; }
    .answer-input{ min-height:44px; }
    .tbox{ width:38px; height:38px; }
    .tile{ width:34px; height:40px; }
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="title">
      <h1>Common Thread â€” Daily</h1>
      <span class="date" id="date"></span>
    </div>
    <button class="help-btn" id="helpBtn" aria-expanded="false" aria-controls="rules">How to play</button>
  </header>

  <div class="panel rules" id="rules" role="region" aria-label="How to play">
    <p>Find the three answers from the clues. Every answer contains the same contiguous three-letter sequence â€” the common thread.</p>
    <ul>
      <li>Type answers in the boxes. Answers use only letters (no spaces or punctuation).</li>
      <li>All three answers share the same 3-letter sequence somewhere inside.</li>
      <li>You can also guess the thread directly (3 letters). This is optional.</li>
      <li>Solve all three answers to win todayâ€™s puzzle.</li>
    </ul>
  </div>

  <div class="panel thread-panel" id="threadPanel">
    <div class="thread-top">
      <div class="thread-label">Thread</div>
      <div class="thread-boxes" id="threadBoxes" aria-label="Thread letters">
        <div class="tbox" aria-hidden="true">?</div>
        <div class="tbox" aria-hidden="true">?</div>
        <div class="tbox" aria-hidden="true">?</div>
      </div>
    </div>
    <div class="thread-input-wrap">
      <label for="threadGuess" class="pill">Guess the 3-letter thread</label>
      <input id="threadGuess" class="thread-input" inputmode="latin" maxlength="3" autocomplete="off" autocapitalize="characters" spellcheck="false" placeholder="___" aria-label="Guess the 3-letter thread">
      <button id="revealBtn" class="btn" title="Reveal the common thread (uses a hint)">Reveal thread</button>
      <span id="threadStatus" class="status"></span>
    </div>
  </div>

  <div id="clues" class="clues" aria-live="polite"></div>

  <div class="win" id="win">
    <h2>Thread tied. Nicely done!</h2>
    <p id="winMsg">You solved todayâ€™s puzzle.</p>
    <div class="share-wrap">
      <button id="shareBtn" class="btn good">Share result</button>
      <span class="pill" id="hintPill">Hints used: 0</span>
    </div>
  </div>

  <footer>
    <div>New puzzle every day â€¢ Local midnight</div>
    <div class="pill">No timer â€¢ No ads â€¢ All offline</div>
  </footer>
</div>

<script>
(function(){
  "use strict";

  // Bank of curated daily puzzles
  const PUZZLES = [
    {thread:"EAR", entries:[
      {answer:"HEART", clue:"Organ that beats"},
      {answer:"BEARD", clue:"Facial hair along the jaw"},
      {answer:"SPEAR", clue:"Thrown hunting weapon"}
    ]},
    {thread:"INK", entries:[
      {answer:"LINK", clue:"Connect or join online"},
      {answer:"BLINK", clue:"Rapid eyelid motion"},
      {answer:"INKWELL", clue:"Bottle for fountain pens"}
    ]},
    {thread:"AST", entries:[
      {answer:"FASTEN", clue:"Secure tightly"},
      {answer:"CASTLE", clue:"Fortified residence"},
      {answer:"COASTAL", clue:"Near the sea"}
    ]},
    {thread:"OOL", entries:[
      {answer:"SCHOOL", clue:"Place for classes"},
      {answer:"STOOL", clue:"Seat without a back"},
      {answer:"COOLER", clue:"More chilled"}
    ]},
    {thread:"IME", entries:[
      {answer:"TIME", clue:"Hours and minutes"},
      {answer:"SLIME", clue:"Gooey green gunk"},
      {answer:"PRIMED", clue:"Prepared and ready"}
    ]},
    {thread:"ORN", entries:[
      {answer:"ORNATE", clue:"Elaborately decorated"},
      {answer:"ACORN", clue:"Oak tree seed"},
      {answer:"HORNED", clue:"Having pointed protrusions"}
    ]},
    {thread:"QUE", entries:[
      {answer:"QUEUE", clue:"Line of people"},
      {answer:"BOUTIQUE", clue:"Chic small shop"},
      {answer:"ANTIQUE", clue:"Old collectible"}
    ]},
    {thread:"FRA", entries:[
      {answer:"FRAGILE", clue:"Easily broken"},
      {answer:"FRACTION", clue:"Part of a whole"},
      {answer:"FRAGRANT", clue:"Pleasant-smelling"}
    ]},
    {thread:"ORE", entries:[
      {answer:"CORE", clue:"Center part"},
      {answer:"BEFORE", clue:"Earlier than"},
      {answer:"SHORELINE", clue:"Where land meets sea"}
    ]},
    {thread:"SCR", entries:[
      {answer:"SCRATCH", clue:"Lightly rake a surface"},
      {answer:"SCREW", clue:"Spiral fastener"},
      {answer:"SCROLL", clue:"Roll through a page"}
    ]},
    {thread:"APE", entries:[
      {answer:"SHAPE", clue:"Form or outline"},
      {answer:"ESCAPE", clue:"Get away"},
      {answer:"LANDSCAPE", clue:"Outdoor scenery"}
    ]},
    {thread:"OWL", entries:[
      {answer:"BOWL", clue:"Round dish"},
      {answer:"HOWL", clue:"Long, loud cry"},
      {answer:"FOWL", clue:"Birds used as food"}
    ]},
    {thread:"GLE", entries:[
      {answer:"EAGLE", clue:"Majestic bird"},
      {answer:"SNUGGLE", clue:"Cuddle closely"},
      {answer:"WRIGGLE", clue:"Twist and squirm"}
    ]},
    {thread:"TIC", entries:[
      {answer:"ARCTIC", clue:"Polar region"},
      {answer:"STATIC", clue:"Unmoving"},
      {answer:"TACTIC", clue:"Planned method"}
    ]},
    {thread:"ILL", entries:[
      {answer:"CHILL", clue:"Make cold"},
      {answer:"THRILL", clue:"Excite greatly"},
      {answer:"QUILL", clue:"Feather writing tool"}
    ]},
    {thread:"LUM", entries:[
      {answer:"LUMBER", clue:"Timber"},
      {answer:"PLUMMET", clue:"Fall sharply"},
      {answer:"LUMINOUS", clue:"Glowing softly"}
    ]},
    {thread:"AFT", entries:[
      {answer:"DRAFT", clue:"Rough version"},
      {answer:"AFTER", clue:"Subsequent to"},
      {answer:"CRAFTY", clue:"Clever in a sly way"}
    ]},
    {thread:"CHA", entries:[
      {answer:"CHAIR", clue:"Seat with a back"},
      {answer:"CHARM", clue:"Magical trinket"},
      {answer:"CHARCOAL", clue:"Fuel for grilling"}
    ]},
    {thread:"NAP", entries:[
      {answer:"NAPTIME", clue:"Brief daytime sleep"},
      {answer:"NAPKIN", clue:"Mealtime wipe"},
      {answer:"SNAPSHOT", clue:"Quick photo"}
    ]},
    {thread:"VER", entries:[
      {answer:"CLEVER", clue:"Smart"},
      {answer:"SEVER", clue:"Cut apart"},
      {answer:"ADVERB", clue:"Word that modifies an adjective, verb, or adverb"}
    ]}
  ];

  // Choose today's puzzle deterministically (UTC date)
  const todayUTC = new Date();
  const y = todayUTC.getUTCFullYear();
  const m = todayUTC.getUTCMonth() + 1;
  const d = todayUTC.getUTCDate();
  const dateKey = y * 10000 + m * 100 + d;
  const dayIndex = dateKey % PUZZLES.length;
  const PUZ = PUZZLES[dayIndex];
  const STORAGE_KEY = "ct-" + dateKey;

  // DOM references
  const dateEl = document.getElementById('date');
  const helpBtn = document.getElementById('helpBtn');
  const rules = document.getElementById('rules');
  const cluesEl = document.getElementById('clues');
  const threadBoxes = document.getElementById('threadBoxes');
  const threadGuess = document.getElementById('threadGuess');
  const revealBtn = document.getElementById('revealBtn');
  const threadStatus = document.getElementById('threadStatus');
  const winEl = document.getElementById('win');
  const shareBtn = document.getElementById('shareBtn');
  const hintPill = document.getElementById('hintPill');

  // Date label (friendly in user's locale, but puzzle is UTC-based)
  dateEl.textContent = new Date(Date.UTC(y, m-1, d)).toLocaleDateString(undefined, {weekday:'short', year:'numeric', month:'short', day:'numeric'}) + " (Daily)";

  // State
  const initialState = {
    answers: ["", "", ""],
    solved: [false, false, false],
    threadGuess: "",
    threadSolved: false,
    hints: 0,
    win: false
  };
  let state = loadState() || initialState;

  // Build thread boxes
  function renderThreadBoxes(){
    threadBoxes.innerHTML = "";
    const letters = PUZ.thread.split("");
    for(let i=0;i<3;i++){
      const b = document.createElement('div');
      b.className = 'tbox' + (state.threadSolved ? ' revealed' : '');
      b.textContent = state.threadSolved ? letters[i] : '?';
      threadBoxes.appendChild(b);
    }
  }
  renderThreadBoxes();

  // Build clues UI
  function buildClues(){
    cluesEl.innerHTML = "";
    PUZ.entries.forEach((entry, idx)=>{
      const row = document.createElement('div');
      row.className = 'clue';
      // number
      const num = document.createElement('div');
      num.className = 'num';
      num.textContent = (idx+1);
      // clue text
      const ct = document.createElement('div');
      ct.className = 'clue-text';
      ct.textContent = entry.clue;

      // answer area
      const area = document.createElement('div');
      area.className = 'answer-area';

      const input = document.createElement('input');
      input.type = 'text';
      input.autocomplete = 'off';
      input.spellcheck = false;
      input.inputMode = 'latin';
      input.placeholder = "Answer " + (idx+1);
      input.ariaLabel = "Answer " + (idx+1) + " input";
      input.className = 'answer-input';
      input.value = (state.answers[idx] || "");
      if(state.solved[idx]){ input.style.display = 'none'; }

      const status = document.createElement('span');
      status.className = 'status';
      status.textContent = 'Length: ' + entry.answer.length;

      const tiles = document.createElement('div');
      tiles.className = 'tiles';
      if(!state.solved[idx]){ tiles.style.display='none'; }

      if(state.solved[idx]){
        paintTiles(tiles, entry.answer, PUZ.thread);
        status.classList.add('good');
        status.textContent = 'Correct';
      }

      input.addEventListener('input', (e)=>{
        const sanitized = (e.target.value || "")
          .toUpperCase()
          .replace(/[^A-Z]/g, "");
        e.target.value = sanitized;
        state.answers[idx] = sanitized;
        saveState();
        // Auto-check when fully typed and length matches
        if(sanitized.length === entry.answer.length){
          checkOne(idx, entry, input, status, tiles);
        }else{
          status.classList.remove('good','bad');
          status.textContent = 'Length: ' + entry.answer.length;
        }
      });

      // Enter key to check
      input.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){
          checkOne(idx, entry, input, status, tiles);
        }
      });

      area.appendChild(input);
      area.appendChild(status);
      area.appendChild(tiles);

      row.appendChild(num);
      row.appendChild(ct);
      row.appendChild(area);
      cluesEl.appendChild(row);

      // If solved previously, keep display
      if(state.solved[idx]){
        input.style.display = 'none';
        tiles.style.display = '';
        paintTiles(tiles, entry.answer, PUZ.thread);
      }
    });
  }
  buildClues();

  // Hook up help
  helpBtn.addEventListener('click', ()=>{
    const open = !rules.classList.contains('open');
    rules.classList.toggle('open', open);
    helpBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
  });

  // Thread guess logic
  threadGuess.value = state.threadGuess || "";
  if(state.threadSolved){
    threadGuess.disabled = true;
    threadGuess.value = PUZ.thread;
    threadStatus.textContent = "Thread found";
    threadStatus.className = "status good";
    revealBtn.disabled = true;
  }

  threadGuess.addEventListener('input', (e)=>{
    const value = (e.target.value || "").toUpperCase().replace(/[^A-Z]/g,"").slice(0,3);
    e.target.value = value;
    state.threadGuess = value;
    saveState();
    if(value.length === 3){
      if(value === PUZ.thread){
        state.threadSolved = true;
        threadStatus.textContent = "Thread found";
        threadStatus.className = "status good";
        renderThreadBoxes();
        threadGuess.disabled = true;
        revealBtn.disabled = true;
        saveState();
      }else{
        threadStatus.textContent = "Not the thread";
        threadStatus.className = "status bad";
      }
    }else{
      threadStatus.textContent = "";
      threadStatus.className = "status";
    }
  });

  revealBtn.addEventListener('click', ()=>{
    const ok = confirm("Reveal the common thread? This uses a hint.");
    if(!ok) return;
    state.hints += 1;
    state.threadSolved = true;
    threadGuess.value = PUZ.thread;
    threadGuess.disabled = true;
    revealBtn.disabled = true;
    threadStatus.textContent = "Thread revealed";
    threadStatus.className = "status good";
    renderThreadBoxes();
    updateHints();
    saveState();
  });

  // Check and win handling
  function checkOne(idx, entry, inputEl, statusEl, tilesEl){
    const correct = (inputEl.value || "").toUpperCase() === entry.answer.toUpperCase();
    if(correct){
      statusEl.textContent = "Correct";
      statusEl.classList.remove('bad');
      statusEl.classList.add('good');
      state.solved[idx] = true;
      state.answers[idx] = entry.answer.toUpperCase();
      // Replace input with tiles
      inputEl.style.display = 'none';
      tilesEl.style.display = '';
      paintTiles(tilesEl, entry.answer, PUZ.thread);
      saveState();
      // Auto-fill thread if not known yet (visual only)
      if(!state.threadSolved){
        // We don't automatically mark it solved, but show hint banner
        // No action needed; tiles already highlight thread visually
      }
      maybeWin();
    }else{
      statusEl.textContent = "Try again";
      statusEl.classList.remove('good');
      statusEl.classList.add('bad');
      shake(inputEl);
    }
  }

  function maybeWin(){
    if(state.solved.every(Boolean) && !state.win){
      state.win = true;
      saveState();
      showWin();
    }
  }

  function showWin(){
    winEl.classList.add('show');
    updateHints();
  }

  function updateHints(){
    hintPill.textContent = "Hints used: " + (state.hints || 0);
  }

  // Tile painter with thread highlight
  function paintTiles(container, word, thread){
    container.innerHTML = "";
    const W = word.toUpperCase();
    const t = thread.toUpperCase();
    const at = W.indexOf(t);
    for(let i=0;i<W.length;i++){
      const span = document.createElement('div');
      span.className = 'tile' + ((i>=at && i<at+3) ? ' thread' : '');
      span.textContent = W[i];
      container.appendChild(span);
    }
  }

  // Little shake for wrong attempt
  function shake(el){
    el.style.transition = 'transform 60ms';
    let i = 0;
    const seq = [-6,6,-4,4,-2,2,0];
    const step = ()=>{
      el.style.transform = `translateX(${seq[i]}px)`;
      i++;
      if(i<seq.length) requestAnimationFrame(step);
    };
    requestAnimationFrame(step);
    setTimeout(()=>{ el.style.transform=''; }, 400);
  }

  // Save/Load state
  function saveState(){
    try{
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }catch(e){}
  }
  function loadState(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return null;
      const parsed = JSON.parse(raw);
      // Ensure shape
      if(!parsed || !Array.isArray(parsed.answers) || !Array.isArray(parsed.solved)) return null;
      return parsed;
    }catch(e){ return null; }
  }

  // If win persisted, show
  if(state.win){ showWin(); }

  // Share result
  shareBtn.addEventListener('click', async ()=>{
    const solved = state.solved.filter(Boolean).length;
    const check = solved === 3 ? "âœ… Solved" : `âŒ ${solved}/3`;
    // Build a mini grid: use ðŸ§µ for thread if solved or revealed
    const threadShown = state.threadSolved ? PUZ.thread : "???";
    const wordsGrid = PUZ.entries.map((e,i)=>{
      const ok = state.solved[i];
      const w = ok ? e.answer.toUpperCase() : "â€”".repeat(e.answer.length);
      // mark thread by brackets
      const W = ok ? markThread(w, PUZ.thread) : w;
      return (ok ? "ðŸŸ© " : "â¬œ ") + W;
    }).join("\n");
    const dt = new Date(Date.UTC(y,m-1,d)).toISOString().slice(0,10);
    const text =
`Common Thread ${dt}
${check} â€¢ Hints: ${state.hints||0}
Thread: ${threadShown}

${wordsGrid}
https://`;
    try{
      if(navigator.share){
        await navigator.share({text});
      }else{
        await navigator.clipboard.writeText(text);
        alert("Result copied to clipboard!");
      }
    }catch(e){
      // fallback
      try{
        await navigator.clipboard.writeText(text);
        alert("Result copied to clipboard!");
      }catch(_){}
    }
  });

  function markThread(word, thread){
    const at = word.indexOf(thread);
    if(at<0) return word;
    return word.slice(0,at) + "[" + thread + "]" + word.slice(at+thread.length);
  }

  // Initialize hints pill
  updateHints();

  // Accessibility: focus first unsolved input
  setTimeout(()=>{
    const firstInput = document.querySelector('.answer-input:not([style*="display: none"])');
    if(firstInput){ firstInput.focus({preventScroll:true}); }
  }, 50);

})();
</script>
</body>
</html>